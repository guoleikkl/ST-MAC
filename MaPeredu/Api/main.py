import sys

sys.path.append('/home/zhengy/ScienceDataAnalyze')
from flask import Flask, request, jsonify
import requests
import urllib.parse
from flask_cors import CORS
import random
import uuid
from glm.glm4Api import GLM4Client
from MaPeredu import MaPeredu
app = Flask(__name__)
CORS(app)  # 允许所有跨域请求

# 知识图谱 API 地址
KG_API_URL = "https://api.ownthink.com/kg/knowledge"
LLM = MaPeredu()
example_content = """  <h2>人工智能、机器学习与深度学习的关系</h2>
  <p>人工智能（Artificial Intelligence，AI）、机器学习（Machine Learning，ML）和深度学习（Deep Learning，DL）是现代智能技术领域的重要概念，它们既相互关联，又各具特点，形成了一种层级递进的关系。</p>

  <h3>1. 人工智能（AI）：智能系统的总体概念</h3>
  <p>人工智能是计算机科学的一个分支，旨在研究如何让机器模拟和实现人类智能，包括理解自然语言、视觉识别、决策制定、问题求解等能力。AI 的目标是让计算机能够执行通常需要人类智能才能完成的任务，如自动驾驶、语音识别、医疗诊断等。</p>

  <h4>AI 可分为两类：</h4>
  <ul>
    <li><strong>弱人工智能（Narrow AI）</strong>：专注于特定任务，如智能语音助手（如 Siri、Alexa）、推荐系统、智能客服等。</li>
    <li><strong>强人工智能（General AI）</strong>：具备类似人类的通用智能，能够自主学习、推理和适应不同环境，但目前仍处于研究阶段。</li>
  </ul>

  <h3>2. 机器学习（ML）：实现人工智能的重要途径</h3>
  <p>机器学习是人工智能的一个子集，它指的是通过数据训练，使计算机能够自动学习和改进，而无需显式编程。机器学习的核心在于算法能够基于数据进行模式识别，并进行预测或决策。</p>

  <h4>常见的机器学习方法包括：</h4>
  <ul>
    <li><strong>监督学习</strong>：使用带有标签的数据进行训练，如图像分类、语音识别等。</li>
    <li><strong>无监督学习</strong>：对无标签数据进行模式发现，如聚类分析、降维等。</li>
    <li><strong>强化学习</strong>：通过奖励机制学习最佳策略，如 AlphaGo 通过强化学习掌握围棋。</li>
  </ul>

  <h3>3. 深度学习（DL）：机器学习的进阶形式</h3>
  <p>深度学习是机器学习的一个子集，主要基于<strong>人工神经网络</strong>（Artificial Neural Networks, ANN）模拟人脑的神经结构，从大量数据中学习特征，并进行复杂的任务处理。</p>

  <h4>深度学习的关键技术：</h4>
"""
#
def get_knowledge(entity):
    """获取知识图谱信息"""
    encoded_entity = urllib.parse.quote(entity)  # 编码实体名
    url = f"{KG_API_URL}?entity={encoded_entity}"
    response = requests.get(url, verify=False)

    return response.json()
def generate_custom_id():
    """生成符合格式的taskid，24位十六进制字符串"""
    return uuid.uuid4().hex[:24]  # 生成32位UUID并截取前24位

@app.route("/kg/mapereduKnowledge", methods=["GET"])
def get_knowledge_update():
    content = request.args.get("content")
    result = LLM.get_knowleage(content=content)
    document = {
        "doc":result
    }
    return jsonify(document)

@app.route("/kg/getSurvey", methods=["GET"])
def getSurvey():
    result = LLM.get_survey()
    document = {
        "survey":result
    }
    return jsonify(document)




@app.route("/kg/mapereduInfo", methods=["GET"])
def get_kg_maperedu_info():
    nodes = [{'id': '人工智能', 'name': '人工智能', 'layer': 1, 'select': 1},
             {'id': '人工智能是模拟人类智能的计算机系统', 'name': '人工智能是模拟人类智能的计算机系统', 'layer': 2,
              'select': 1}, {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1},
             {'id': '深度学习', 'name': '深度学习', 'layer': 2, 'select': 1},
             {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1},
             {'id': '机器学习是一种通过数据训练模型的技术', 'name': '机器学习是一种通过数据训练模型的技术', 'layer': 3,
              'select': 1}, {'id': '深度学习', 'name': '深度学习', 'layer': 3, 'select': 0},
             {'id': '深度学习', 'name': '深度学习', 'layer': 4, 'select': 1},
             {'id': '深度学习是一种基于神经网络的机器学习方法', 'name': '深度学习是一种基于神经网络的机器学习方法',
              'layer': 5, 'select': 1}]
    graph_data = {'nodes': nodes,
                  'links': [{'source': '人工智能', 'target': '人工智能是模拟人类智能的计算机系统', 'label': '定义'},
                            {'source': '人工智能', 'target': '机器学习', 'label': '技术'},
                            {'source': '人工智能', 'target': '深度学习', 'label': '技术'},
                            {'source': '机器学习', 'target': '机器学习是一种通过数据训练模型的技术', 'label': '定义'},
                            {'source': '机器学习', 'target': '深度学习', 'label': '相关技术'},
                            {'source': '深度学习', 'target': '深度学习是一种基于神经网络的机器学习方法',
                             'label': '定义'}]}
    content = example_content
    answer = {
        'taskid':generate_custom_id(),
        'graphData':graph_data,
        'content':content,
        'field':'计算机科学'
    }
    return jsonify(answer)




@app.route("/kg/tasks", methods=["GET"])
def getTask():
    tasks = [{
                'taskid': generate_custom_id(),
                'isFinish': 1,
                'process': '100%',
                'belonging': 'Zheng',
                'entity': '人工智能',
                'createTime': '2024年11月30日',
                'graphData': {
                    "links":[{'source': '人工智能', 'target': '人工智能是模拟人类智能的计算机系统', 'label': '定义'}, {'source': '人工智能', 'target': '机器学习', 'label': '技术'}, {'source': '人工智能', 'target': '深度学习', 'label': '技术'},{'source': '机器学习', 'target': '机器学习是一种通过数据训练模型的技术', 'label': '定义'}, {'source': '机器学习', 'target': '深度学习', 'label': '相关技术'}, {'source': '深度学习', 'target': '深度学习是一种基于神经网络的机器学习方法', 'label': '定义'}],
                    "nodes": [{'id': '人工智能', 'name': '人工智能', 'layer': 1, 'select': 1}, {'id': '人工智能是模拟人类智能的计算机系统', 'name': '人工智能是模拟人类智能的计算机系统', 'layer': 2, 'select': 1},  {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1}, {'id': '深度学习', 'name': '深度学习', 'layer': 2, 'select': 1}, {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1}, {'id': '机器学习是一种通过数据训练模型的技术', 'name': '机器学习是一种通过数据训练模型的技术', 'layer': 3, 'select': 1},{'id': '深度学习', 'name': '深度学习', 'layer': 3, 'select': 0}, {'id': '深度学习', 'name': '深度学习', 'layer': 4, 'select': 1}, {'id': '深度学习是一种基于神经网络的机器学习方法', 'name': '深度学习是一种基于神经网络的机器学习方法', 'layer': 5, 'select': 1}]
                },
                'content': example_content,
            }]
    entities = ['机器学习', '机器人', '深度学习', '知识图谱', '自然语言处理']
    for entity in entities:
        result = get_knowledge(entity)
        graph_data = construct_graph_data(result)
        task = {
            'taskid': generate_custom_id(),  # 随机生成唯一任务ID
            'isFinish': random.choice([0, 1]),  # 随机设置任务是否完成
            'process': f"{random.randint(10, 100)}%",  # 随机生成进度
            'belonging': 'Zheng',  # 随机任务归属
            'entity': entity,
            'createTime': f"2024年{random.randint(1, 12)}月{random.randint(1, 28)}日",
            'graphData': graph_data,
            'content': f"{entity}文章已完成，点击展开查看文章。"
        }
        tasks.append(task)
    return tasks
@app.route("/kg/analyzeDoc", methods=["GET"])
def getAnalyze():
    updateKnowledge = """
        人工智能（AI）、机器学习（ML）和深度学习（DL）的融合彻底改变了智能系统领域，它们各自在技术进步的进程中扮演着独特的角色。<h2>人工智能、机器学习和深度学习：理解它们之间的关系</h2><p>人工智能（AI）、机器学习（ML）和深度学习（DL）是现代智能技术领域的关键概念。它们相互关联，各具特色，形成了一种层次递进的关系。</p><h3>1. 人工智能（AI）：智能系统的总体概念</h3><p>人工智能是计算机科学的一个分支，致力于使机器能够模拟并实现人类智能，包括自然语言理解、视觉识别、决策和问题解决等能力。人工智能的目标是使计算机能够执行通常需要人类智能的任务，如自动驾驶、语音识别和医疗诊断。</p><h4>人工智能可以分为两种类型：</h4><ul>  <li><strong>窄人工智能（弱人工智能）</strong>：专注于特定任务，如智能语音助手（例如，Siri、Alexa）、推荐系统和智能客户服务。</li>  <li><strong>通用人工智能（强人工智能）</strong>：具有类似于人类的通用智能，能够学习、推理和适应不同的环境。然而，通用人工智能仍处于研究阶段。</li></ul><h3>2. 机器学习（ML）：实现人工智能的关键方法</h3><p>机器学习是人工智能的一个子集，指的是训练计算机自动学习和改进的过程，而不需要明确的编程。机器学习的核心在于能够从数据中识别模式并做出预测或决策的算法。</p><h4>常见的机器学习方法包括：</h4><ul>  <li><strong>监督学习</strong>：使用标记数据进行训练，如图像分类和语音识别。</li>  <li><strong>无监督学习</strong>：在未标记数据中发现模式，如聚类分析和降维。</li>  <li><strong>强化学习</strong>：通过奖励机制学习最佳策略，如AlphaGo通过强化学习掌握围棋。</li></ul><h3>3. 深度学习（DL）：机器学习的高级形式</h3><p>深度学习是机器学习的一个子集，主要依赖于模拟人脑神经结构的<strong>人工神经网络（ANNs）</strong>。它从大量数据集中学习特征，并执行复杂任务处理。</p><h4>深度学习的关键技术包括：</h4><ul>  <li><strong>神经网络</strong>：一系列试图通过模拟人脑运作方式来识别数据集中潜在关系的算法。</li>  <li><strong>反向传播</strong>：用于训练神经网络的算法，通过调整网络的权重和偏差来最小化预测输出与实际输出之间的误差。</li>  <li><strong>卷积神经网络（CNNs）</strong>：一类深度神经网络，特别适合分析视觉图像。</li>  <li><strong>循环神经网络（RNNs）</strong>：一类能够识别数据序列中模式（如时间序列或自然语言）的神经网络。</li></ul>从人工智能到机器学习再到深度学习的演变，代表了智能系统能力的重大飞跃，深度学习在处理复杂和大规模数据分析任务方面尤其强大。这为医疗保健、金融和自动驾驶等领域的发展铺平了道路，在这些领域中，处理和解释大量数据的能力至关重要。
        """
    score = LLM.get_score(updateKnowledge)
    style_change = LLM.styleChange(updateKnowledge)
    print(style_change)
    analyze_info = {
        'entity': '人工智能',
        'createTime': '2024年11月30日',
        'graphData': {
            "links": [{'source': '人工智能', 'target': '人工智能是模拟人类智能的计算机系统', 'label': '定义'},
                      {'source': '人工智能', 'target': '机器学习', 'label': '技术'},
                      {'source': '人工智能', 'target': '深度学习', 'label': '技术'},
                      {'source': '机器学习', 'target': '机器学习是一种通过数据训练模型的技术', 'label': '定义'},
                      {'source': '机器学习', 'target': '深度学习', 'label': '相关技术'},
                      {'source': '深度学习', 'target': '深度学习是一种基于神经网络的机器学习方法', 'label': '定义'}],
            "nodes": [{'id': '人工智能', 'name': '人工智能', 'layer': 1, 'select': 1},
                      {'id': '人工智能是模拟人类智能的计算机系统', 'name': '人工智能是模拟人类智能的计算机系统',
                       'layer': 2, 'select': 1}, {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1},
                      {'id': '深度学习', 'name': '深度学习', 'layer': 2, 'select': 1},
                      {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1},
                      {'id': '机器学习是一种通过数据训练模型的技术', 'name': '机器学习是一种通过数据训练模型的技术',
                       'layer': 3, 'select': 1}, {'id': '深度学习', 'name': '深度学习', 'layer': 3, 'select': 0},
                      {'id': '深度学习', 'name': '深度学习', 'layer': 4, 'select': 1},
                      {'id': '深度学习是一种基于神经网络的机器学习方法',
                       'name': '深度学习是一种基于神经网络的机器学习方法', 'layer': 5, 'select': 1}]
        },
        'content': example_content,
        'score':score,
        'style_change': style_change,
        'report':{'ID': '1', 'document': '\n    您是否曾想过，机器如何模仿人类智能并执行通常需要人类认知能力的任务？人工智能（AI）、机器学习（ML）和深度学习（DL）这三个领域已经彻底改变了智能系统的领域，每个领域都在技术进步中扮演着独特的角色。但这三个概念之间究竟有何关系呢？让我们深入探讨AI、ML和DL的复杂性。什么是人工智能（AI），它与人类智能有何不同？人工智能是计算机科学的一个分支，旨在使机器能够模拟并实现人类智能，包括自然语言理解、视觉识别、决策和解决问题的能力。AI的目标是使计算机能够执行通常需要人类智能的任务，如自动驾驶、语音识别和医疗诊断。AI可以分为两种类型：窄AI（弱AI）和通用AI（强AI）。窄AI专注于特定任务，例如智能语音助手（如Siri、Alexa）、推荐系统和智能客户服务。另一方面，通用AI拥有类似于人类的通用智能，能够学习、推理和适应各种环境。然而，通用AI目前仍处于研究阶段。机器学习（ML）是如何有助于实现AI的？机器学习是AI的一个子集，指的是训练计算机自动学习和改进的过程，而不需要明确的编程。ML的核心在于算法能够识别数据中的模式并做出预测或决策。常见的ML方法包括：- 监督学习：使用标记数据进行训练，如图像分类和语音识别。- 无监督学习：在未标记数据中发现模式，如聚类分析和降维。- 强化学习：通过奖励机制学习最佳策略，如AlphaGo通过强化学习掌握围棋。什么是深度学习（DL），它是如何推进机器学习的？深度学习是ML的一个子集，主要依赖于模拟人脑结构的神经网络。DL从大量数据集中学习特征，并执行复杂的任务处理。DL的关键技术包括：- 神经网络：通过模拟人脑功能尝试识别数据中潜在关系的算法。- 反向传播：一种通过调整权重和偏差来最小化预测输出与实际输出之间误差的算法。- 卷积神经网络（CNN）：一种特别适合分析视觉图像的深度神经网络。- 循环神经网络（RNN）：一种能够识别数据序列（如时间序列或自然语言）中模式的神经网络。从AI到ML再到DL的演变代表了智能系统能力的一次重大飞跃。DL在处理复杂和大规模数据分析任务方面特别强大，为医疗保健、金融和自动驾驶等领域的发展铺平了道路，在这些领域，处理和解释大量数据的能力至关重要。总之，AI、ML和DL是相互关联的概念，它们相互构建，形成一个层次结构。理解它们之间的关系和功能对于欣赏智能系统领域的进步和它们对未来所持有的潜力至关重要。\n    ', 'SR_COT_FB_agent1_1': '根据提供的评估标准，文本中两个最具讨论性的问题是“科学词汇选择”和“科学准确性”。1. **科学词汇选择**：文本中使用了相当数量的专业术语，这对于主题内容来说是合适的；然而，在少数情况下，科学术语的精确性可以进一步提高。例如，使用“弱人工智能”来描述“窄人工智能”有些名不副实。通常，“弱人工智能”是指为特定任务设计且无法将其训练数据之外的泛化能力。而“强人工智能”用来描述“通用人工智能”，这也有些简化，因为关于“强人工智能”的定义以及它是否能够实现，目前存在持续的争论。这种术语的选择可能会让不熟悉人工智能术语的读者感到困惑。2. **科学准确性**：文本中提出了一些可能存在争议或未被普遍接受的概念。例如，关于“人工智能的目标是使计算机能够执行通常需要人类智能的任务”的表述是一个过于宽泛的声明，可能并不完全准确。虽然人工智能能够执行需要人类智能的任务，但这并不一定是人工智能的目标；相反，这是人工智能系统设计来实现的 capabilities。此外，关于“通用人工智能目前仍处于研究阶段”的说法也是一种简化。虽然通用人工智能是一个具有挑战性和持续进行的研究领域，但已经存在或正在开发的各种人工智能系统，它们可能不被归类为“通用人工智能”，但仍然表现出显著的智能。总之，文本可以从更精确地使用与人工智能相关的术语和对一些概念，尤其是那些在科学界持续争论或未被普遍接受的概念的更清晰阐述中受益。', 'SR_COT_FB_Reflection1_1': '经过重新考虑，我将提供对文本的更详细评估，重点关注已识别的问题，并考虑其他潜在的关注领域：1. **科学词汇选择**： - 使用“弱人工智能”来描述“窄人工智能”确实存在争议。虽然文本试图阐明窄人工智能是弱人工智能的一个子集，但两者之间的区别可能相当微妙。“弱人工智能”一词可能暗示了能力上的限制，而这在窄人工智能系统中并不一定成立。明确指出窄人工智能是指为特定任务设计的系统，这更符合该术语的普遍理解，将是有益的。 - “强人工智能”一词确实是一个有争议的话题。文本可以从更细致的角度讨论强人工智能的定义以及该领域的研究现状。当前对“强人工智能”的使用可能过于简化，可能导致误解。 - “机器学习”和“深度学习”这两个术语的重复使用，而没有始终区分它们，可能会让对领域不熟悉的读者感到困惑。2. **科学准确性**： - 关于人工智能目标的陈述过于笼统。虽然确实人工智能系统被设计来执行需要人类智能的任务，但人工智能的目标更为复杂和多元化。更准确的说法可能是，人工智能旨在在各个领域复制或增强人类智能。 - 声称通用人工智能仍处于研究阶段是一种简化。尽管通用人工智能确实是一个具有挑战性的目标，但仍然存在各种人工智能应用，它们不属于通用人工智能类别，但仍然非常复杂且具有实际应用。 - 文中提到“深度学习从大量数据集中学习特征并执行复杂任务”，这一点通常来说是准确的，但它可以更清楚地说明深度学习是机器学习的一个子集，而不是一个独立的过程。其他关注领域： - **逻辑不一致**：对“机器学习”和“深度学习”等术语缺乏明确的定义，可能会导致混淆。例如，文本在机器学习部分讨论了“监督学习”、“无监督学习”和“强化学习”，但并不总是清楚地说明这些与深度学习的关系。 - **连续性**：从人工智能到机器学习再到深度学习的过渡很流畅，但可以更明确地解释每个领域是如何建立在之前的领域的，特别是对于对该领域不熟悉的读者。 - **科学连贯性**：文本结构良好，但在某些方面，为了提高连贯性，流程可以有所改进。例如，在深度学习的背景下引入神经网络之前，可以简要解释神经网络是什么。 - **参与度与可读性**：文本提供信息，但缺乏能够更积极吸引读者的叙事技巧或问题。使用类比或现实世界的例子可以提高可读性和参与度。总之，尽管文本提供了关于人工智能、机器学习和深度学习的好概述，但在科学术语的使用方面仍有改进的空间，以提高清晰度和准确性。此外，文本可以从更细致的概念讨论和它们之间的关系中受益，同时也要提高目标受众的参与度。', 'SR_COT_FB_agent1_2': '我对文本的分析，尤其是在科学清晰度、逻辑流程和读者参与度方面，与Mike的观察意见相符，但也存在一些细微差别：1. **科学清晰度**：   - **科学词汇选择**：我同意Mike关于“弱AI”和“强AI”使用的观点。窄AI和通用AI之间的区别很重要，文本如果能提供更清晰的解释以避免混淆将更有益。可以将“弱AI”一词替换为“窄AI”，以更准确地反映当前领域的理解。   - **科学准确性**：AI的目标确实是多方面的，文本在说明AI系统旨在模拟或增强人类智能，而不仅仅是执行需要人类智能的任务时，可以更加精确。此外，关于通用AI研究阶段的说法是准确的，但可以进一步扩展，以承认AI发展的各个阶段。2. **逻辑流程**：   - 从AI到ML再到DL的过渡解释得很好，但正如Mike所指出的，可以更明确地解释每个阶段是如何建立在之前的阶段之上的。例如，可以在机器学习的背景下更早地介绍神经网络在深度学习中的作用，以提供更清晰的联系。   - 文本在解释不同类型的机器学习方面做得很好，但它可以提供更多细节，说明这些方法如何不同，以及在何时使用它们最为合适。3. **读者参与度**：   - 文本具有信息性，但缺乏可能使其更具吸引力的叙述技巧或问题。包括更多关于AI、ML和DL在现实世界中的应用示例或轶事，可以帮助读者在更个人化的层面上与材料建立联系。   - 使用类比或隐喻也可以提高可读性和参与度。例如，将神经网络与人类大脑进行比较可能有助于读者更直观地理解深度学习的概念。总之，文本为理解AI、ML和DL提供了坚实的基础，但在清晰度、精确度和参与度方面仍有改进的空间。以下是一些具体的建议：   - **科学词汇选择**：澄清“弱AI”和“强AI”这两个术语，使其与当前用法一致，并更明确地区分机器学习和深度学习。   - **逻辑流程**：以更互联的方式介绍概念，提供更清晰的解释，说明AI和ML的不同组成部分如何相互作用。   - **读者参与度**：融入更多叙述元素、现实世界案例和类比，使内容对读者来说更具相关性和吸引力。通过解决这些问题，文本可以变得更加易于理解、准确且吸引人，从而面向更广泛的受众。', 'SR_COT_FB_Reflection1_2': '在重新评估该科学文章后，我将重新审视已识别的问题，并检查其他潜在的关切领域。以下是更新后的评估：**科学词汇选择：**- 使用“弱人工智能”来描述“窄人工智能”确实会引起混淆，因为“弱人工智能”可能暗示了窄人工智能系统本身并不固有的限制。更准确的做法是使用“窄人工智能”来描述为特定任务设计且不具备通用智能的系统。- “强人工智能”这一术语确实存在争议，文章可以从更细致的解释中受益，说明构成强人工智能的标准以及当前的研究格局。- 在没有明确区分的情况下重复使用“机器学习”和“深度学习”可能会对不熟悉该领域的读者造成问题。文章应提供这些术语及其子集之间的更明确联系。**科学准确性：**- 关于人工智能目标的陈述可以更加精确。人工智能的目标并非一定是执行需要人类智能的任务，而是模仿或增强人类智能在各个领域的应用。- 认为通用人工智能仍处于研究阶段的说法过于简化。虽然通用人工智能是一个复杂且持续的研究领域，但已有一些具有高级功能的AI系统并不被归类为通用人工智能。**其他问题：****逻辑不一致：**- 文本并不总是提供“机器学习”和“深度学习”的明确定义，这可能导致混淆。这些术语及其子集（监督学习、无监督学习、强化学习以及各种类型的神经网络）之间的关系应更明确地解释。**连续性：**- 从人工智能到机器学习再到深度学习的过渡是顺畅的，但可以更明确地解释每个阶段如何建立在之前的基础上，特别是对于新进入该领域的读者来说。例如，可以在机器学习的背景下更早地介绍神经网络在深度学习中的作用。**科学连贯性：**- 文本结构良好，但在某些方面，为了提高连贯性，流程可以有所改善。例如，在深度学习的背景下介绍神经网络之前，可以简要解释什么是神经网络。**参与度与可读性：**- 文本提供了信息，但缺乏能够更积极地吸引读者的叙事技巧或问题。使用类比、现实世界例子和讲故事可以增强可读性和参与度。**修订后的评估：**- 文章有清晰的科学解释，但像“弱人工智能”和“强人工智能”这样的术语的使用可以改进以提高清晰度。- 通过提供AI、ML和DL之间的更明确联系，以及不同类型的机器学习和深度学习方法之间的联系，可以增强逻辑流程。- 通过融入更多叙事元素和现实世界例子，可以提高参与度和可读性。总之，尽管文章提供了AI、ML和DL的全面概述，但在科学术语的使用、逻辑流程和读者参与度方面仍有改进的空间。解决这些问题将使文章对更广泛的受众更具可访问性和信息性。', 'Feedback_1': '讨论涵盖了文本科学准确性和清晰性的关键方面。然而，仍有改进空间：1. **遗漏/误解**：对术语的关注较多，但对上下文关注较少。对于“弱人工智能”和“强人工智能”的定义中的误解需要进一步澄清。此外，对机器学习和深度学习之间的区别需要更多强调。2. **冗余/无关对话**：一些关于术语的重复观点可以进行精简。讨论可以从对文本结构和流程的直接反馈中受益。3. **下一轮改进建议**：- **科学概念**：增强对人工智能、机器学习和深度学习的解释，确保清晰和精确。- **逻辑流程**：加强概念之间的联系，以增强连贯性。- **参与度**：引入叙事技巧和现实世界案例，提高可读性。需要在术语和文本结构上达成共识。鼓励采取平衡的方法，在保持科学有效性的同时，提高参与度和清晰度。', 'SR_COT_FB_agent2_1': '考虑到收到的反馈以及提出的新要求，我现在将提供对文本的更全面分析，解决之前提出的问题：**重复问题**：文本中确实存在一些重复，尤其是在机器学习和深度学习方法的解释中。例如，监督学习、无监督学习和强化学习的描述在机器学习和深度学习的上下文中都有重复。虽然这种重复有助于强化概念，但可以通过精简内容来避免冗余，并提高清晰度。**逻辑不一致**：文本在科学解释方面似乎没有逻辑上的不一致之处。然而，在窄人工智能和弱人工智能，以及通用人工智能和强人工智能之间的区分不够清晰，这可以被视为术语使用上的一种不一致。**连续性问题**：文章从人工智能到机器学习再到深度学习的过渡是平滑的，但缺乏对每个概念如何建立在先前概念之上的明确解释。这可能会让对领域不熟悉的读者感到不连贯。**科学词汇选择**：科学术语的使用总体上是正确的，但在某些地方术语可以更加精确。特别是在窄人工智能和弱人工智能，以及通用人工智能和强人工智能之间的区分尤为重要，需要更加明确地定义。**科学准确性**：文章准确介绍了人工智能、机器学习和深度学习的能力和目标。然而，关于人工智能目标的陈述可以更加细腻，因为它不仅关乎执行需要人类智能的任务，还关乎模仿或增强人类智能。考虑到反馈和新增要求，以下是对文本的更新评估：- **科学词汇选择**：文本应澄清“弱人工智能”和“强人工智能”这两个术语，以符合当前的科学发展理解，并更明确地区分机器学习和深度学习。- **科学准确性**：文章应提供对人工智能目标更加精确的描述，并承认人工智能发展的各个阶段，包括那些不被归类为通用人工智能的AI系统的发展。- **逻辑流程**：文本应加强人工智能、机器学习和深度学习之间的联系，并更清晰地解释神经网络如何融入机器学习和深度学习的更广泛背景。- **参与度**：文章可以通过加入叙事技巧、现实世界案例和类比来提高可读性，并更有效地吸引读者。- **重复问题**：文本应编辑以减少不必要的重复，特别是在机器学习和深度学习方法的解释中。- **逻辑不一致**：尽管文本在科学解释上没有不一致之处，但它应确保使用的术语一致且清晰。- **连续性问题**：文章应提供更明确的解释，说明人工智能、机器学习和深度学习层次结构中的每个概念如何建立在先前概念之上，以保持逻辑流程。通过解决这些问题，文本可以得到改进，从而提供更清晰、更有吸引力且科学性更强的关于人工智能、机器学习和深度学习的概述。', 'SR_COT_FB_Reflection2_1': '在仔细重新审视这篇科学文章后，我发现了以下问题和额外关注点：**科学词汇选择**：- “弱AI”和“强AI”的使用可能会造成误导。通常，“弱AI”用来描述为特定任务设计的系统，这更准确地应称为“窄AI”。“强AI”或“通用AI”是指能够执行人类能够进行的任何智力任务的AI。文本应明确这些区别。- “机器学习”一词的使用没有始终区分它与“深度学习”，而深度学习是机器学习的一个子集。这可能会让不熟悉每个特定角色的读者感到困惑。**科学准确性**：- 陈述“AI的目标是使计算机能够执行通常需要人类智能的任务”过于简化了AI的目标。AI旨在增强和模拟人类智能，而不仅仅是执行需要它的任务。- 声明“通用AI目前仍处于研究阶段”是一种简化。虽然通用AI确实具有挑战性，但也有一些AI的实际应用，它们不符合通用AI的定义，但仍然非常先进。**其他问题**：**逻辑不一致**：- 文本没有提供“机器学习”和“深度学习”的明确定义，这可能导致混淆。这些术语及其子集之间的关系应更明确地解释。**间断性**：- 从AI到ML再到DL的过渡很顺畅，但没有明确解释每个概念是如何建立在先前概念之上的，这可能会打断对领域新手的逻辑流程。**参与度与可读性**：- 文本提供了信息，但缺乏能够更积极地吸引读者的叙述技巧或问题。包含现实世界案例研究可以增强参与度。**修订评估**：- 文本应提供更精确和细微的解释，包括AI、ML和DL的目标以及所用术语的定义。- 通过清楚地解释概念之间的关系及其演变，应加强逻辑流程。- 为了提高参与度，文本应融入更多叙述元素、现实世界案例和类比，使内容更具相关性和可及性。通过解决这些问题，文章可以提升，为预期读者提供更准确、连贯和引人入胜的AI、ML和DL概述。', 'SR_COT_FB_agent2_2': '两位评审员提供的反馈具有洞察力，指出了文章需要改进的几个关键领域。以下是对科学清晰度、逻辑连贯性和可读性的客观评估：**科学清晰度：**- 文章在解释像AI、ML和DL这样的复杂概念方面做得不错。然而，在“弱AI”与“窄AI”以及“强AI”与“通用AI”之间的区别上缺乏清晰性，这可能会让不熟悉AI术语细微差别的新读者感到困惑。- 文章可以从对“机器学习”和“深度学习”以及它们相互关系和其他ML子集关系的更精确定义中受益。**逻辑连贯性：**- 从AI到ML再到DL的过渡很流畅，但文章可以通过提供更明确的解释来改善，说明每个概念是如何建立在先前概念之上的。这将帮助读者理解这些领域的进展和相互依赖性。- 缺乏对“机器学习”和“深度学习”的明确定义，这可能导致试图理解这些术语及其子集之间关系的读者出现逻辑上的不一致。**可读性：**- 文章提供了信息，但缺乏能够更积极地吸引读者的叙事技巧或问题。包含现实世界的例子、案例研究或类比可以增强可读性，使内容更具相关性。- 某些概念，如不同类型的机器学习方法，的重复可以简化，以避免冗余并提高清晰度。**重复：**- 文章确实存在一些重复，尤其是在机器学习和深度学习方法的解释中。这种重复可以通过减少来改善文本的流畅性。**逻辑不一致性：**- 尽管文章在科学解释上似乎没有逻辑上的不一致，但术语使用上的缺乏清晰性可以被视为一种不一致。**间断性：**- 从AI到ML再到DL的过渡很流畅，但缺乏对这些概念之间相互作用的明确解释可能会给新领域的读者造成间断感。**参与度：**- 文章可以通过融入叙事元素、现实世界例子和类比来提高参与度，帮助读者与材料建立联系。总之，文章为理解AI、ML和DL提供了坚实的基础，但通过解决以下问题可以显著改进：- 阐明和标准化AI相关术语的使用。- 通过提供更清晰的概念间联系来增强逻辑流程。- 通过使用叙事技巧和现实世界例子来提高可读性和参与度。', 'SR_COT_FB_Reflection2_2': '经过对科学文章中指出的问题的仔细重新考虑和核实，以下是对其的更新评估：**科学词汇选择：**- 文章确实使用“弱人工智能”来描述“窄人工智能”，这是一个误称。应予以澄清，以避免混淆。- 使用“强人工智能”来描述“通用人工智能”，这是一个持续争论的话题。文章可以受益于对人工智能不同级别及其实现强人工智能的挑战进行更详细的解释。- “机器学习”和“深度学习”的重复使用没有明确区分，这可能会让读者感到困惑。**科学准确性：**- 人工智能的目标被广泛表述为使计算机执行需要人类智能的任务。这可以进一步细化，强调增强和模仿人类智能。- 声称通用人工智能仍处于研究阶段是一种简化。文章可以承认那些不符合通用人工智能定义但仍然高度复杂的AI系统所取得的进展。**逻辑不一致：**- 在窄人工智能和弱人工智能、以及通用人工智能和强人工智能之间的区分缺乏清晰性，这可以被视为术语使用上的逻辑不一致。- 机器学习与其子集（如监督学习、无监督学习和强化学习）与深度学习之间的关系并不总是得到清晰的解释。**不连贯性：**- 从人工智能到机器学习再到深度学习的过渡是平滑的，但文章可以从更明确地解释每个概念如何建立在之前的基础上，以保持逻辑连贯性。**其他问题：**- 文章可以通过提供“机器学习”和“深度学习”的更精确定义以及它们相互之间和其他机器学习子集之间的关系来得到改进。- 缺乏对“机器学习”和“深度学习”的明确定义，这可能导致试图理解这些术语及其子集之间关系的读者出现逻辑不一致。**修改后的评估：**- 为了改进文章，应考虑以下变更：  - 澄清“弱人工智能”、“窄人工智能”、“强人工智能”和“通用人工智能”等术语，使其与当前的科学发展理解相一致。  - 提供对人工智能目标的更细致的解释，强调增强和模仿人类智能。  - 通过清楚地解释人工智能、机器学习和深度学习之间的关系，以及神经网络在更广泛背景中的位置，来增强逻辑连贯性。  - 简化机器学习和深度学习方法的解释，避免重复并提高清晰度。  - 采用叙事技巧、现实世界例子和类比，以增强参与度和可读性。通过解决这些问题，文章可以在科学清晰度、逻辑一致性和针对目标受众的参与度方面得到显著改进。', 'Feedback_2': '1. 评估过程主要涵盖了科学准确性和清晰度，但未能注意到人工智能术语定义中可能存在的混淆风险。2. 部分对话内容重复，可以合并以提供更简洁的反馈。3. 在下一轮评估中，我建议重点关注以下方面：    - 澄清人工智能术语，以避免误解。   - 通过更明确地关联概念来增强逻辑流程。   - 通过使用现实世界案例和叙事技巧来提升参与度。   应就术语和结构达成共识，在科学有效性与清晰度和参与度之间取得平衡。', 'SR_COT_FB_agent3_1': '针对提供的反馈和关注的问题，以下是对文章的科学清晰度、逻辑一致性和可读性的分析：**重复问题**：文章中确实存在重复的例子，尤其是在机器学习和深度学习方法的解释中。监督学习、无监督学习和强化学习的描述在机器学习和深度学习的背景下都有重复。这种重复可以通过精简来提高清晰度和吸引力，同时不牺牲必要的信息。**逻辑不一致**：文章在科学解释中似乎没有逻辑上的不一致。然而，“弱人工智能”、“窄人工智能”、“强人工智能”和“通用人工智能”的定义并不一致，这可能导致混淆。缺乏对“机器学习”和“深度学习”的明确定义也造成了潜在的逻辑不一致。**连续性问题**：从人工智能到机器学习再到深度学习的过渡通常是平稳的，但缺乏对每个概念如何建立在先前概念之上的明确解释，可能会给新入行的读者造成连续性的中断感。例如，在深度学习的背景下引入神经网络时，如果能更清晰地将其与更广泛的机器学习概念联系起来，将会有所帮助。**科学词汇选择**：文章中使用的术语通常是正确的，但在某些术语的清晰度和精确度方面仍有改进的空间。例如，“弱人工智能”与“窄人工智能”以及“强人工智能”与“通用人工智能”之间的区别可以更加明确地定义，以避免误解。**科学准确性**：文章准确介绍了人工智能、机器学习和深度学习的能力和目标。然而，人工智能的目标被过于笼统地描述，关于通用人工智能研究阶段的说法也可以更加细腻，以反映人工智能发展的当前状态。**修改后的评估**：- **科学词汇选择**：为了提高清晰度，文章应一致且准确地定义和使用与人工智能相关的术语。这包括明确区分“弱人工智能”与“窄人工智能”以及“强人工智能”与“通用人工智能”。- **逻辑一致**：通过明确地联系概念并解释每个概念如何建立在先前的概念之上，可以增强逻辑流程，帮助读者更清楚地理解思想的进展。- **吸引力**：为了提高吸引力，文章可以融入更多的叙事技巧、现实世界案例和类比。这将使内容对更广泛的受众更具相关性和可接近性。- **重复问题**：减少不必要的重复，特别是在机器学习和深度学习方法的解释中，将改善文本的流畅性并提高可读性。- **逻辑不一致**：确保“机器学习”及其子集等术语之间的关系得到清晰解释，将有助于避免逻辑上的不一致。- **连续性问题**：提供更明确的解释，说明人工智能、机器学习和深度学习之间的相互作用，将保持逻辑流程并帮助读者跟随概念的进展。通过解决这些问题，文章可以经过改进，提供更科学准确、逻辑一致且引人入胜的人工智能、机器学习和深度学习概述。', 'SR_COT_FB_Reflection3_1': '经过仔细的重新考虑和核实，在科学文章中发现了以下问题，以及可能出现类似问题的潜在领域：**科学词汇选择**：使用“弱人工智能”和“强人工智能”可能会导致问题，因为它们经常被混用，造成混淆。文章应更清晰地定义这些术语，并使用“窄人工智能”来描述为特定任务设计的系统。- “通用人工智能”一词的使用未明确其范围，可能导致误解。重要的是要明确，通用人工智能指的是能够执行人类可以完成的任何智力任务的人工智能。- **科学准确性**：人工智能的目标被描述为让计算机执行需要人类智能的任务，这过于简单化。人工智能的目标应描述为模拟或增强人类智能在各个领域的应用。- 关于通用人工智能仍处于研究阶段的说法过于简化。虽然通用人工智能确实是一个复杂的目标，但也有一些人工智能应用不被归类为通用人工智能，但仍然非常复杂。- **逻辑不一致**：缺乏对“机器学习”和“深度学习”的明确定义可能导致逻辑不一致。重要的是要建立这些术语及其子集之间的清晰层次关系和关系。- **连续性**：从人工智能到机器学习再到深度学习的过渡是平滑的，但没有明确解释每个概念是如何建立在先前概念之上的，这可能会破坏对人工智能领域新手的逻辑流程。- **其他问题**：文章重复解释了机器学习和深度学习方法，这些方法可以简化以提高清晰度和参与度。- 文本可以通过更多叙事技巧和现实世界案例来提高内容的吸引力和与受众的相关性。- **修订评估**：文章应修订，以提供更精确和一致的人工智能相关术语使用。- 通过清晰地解释人工智能、机器学习和深度学习之间的关系，以及神经网络如何融入机器学习的更广泛背景，来改善逻辑流程。- 为了增强参与度，文本应包含更多叙事元素、现实世界案例和类比。- 减少重复以提高文本的可读性。- 应解决关键术语定义不明确的问题，以避免逻辑不一致并确保对概念有清晰的理解。通过解决这些问题，文章在科学准确性、逻辑一致性和可读性方面可以得到显著改进。', 'SR_COT_FB_agent3_2': '我同意Mike和评估者对这篇科学文章的评估。关注科学清晰度、逻辑连贯性和可读性是很有道理的，并且所识别出的问题对于提升文本质量具有重要意义。以下是我的评估和建议：**科学清晰度：**- 文章在解释人工智能、机器学习和深度学习的概念方面有一个良好的基础。然而，对于“机器学习”和“深度学习”缺乏明确的定义，以及“弱人工智能”、“窄人工智能”、“强人工智能”和“通用人工智能”等术语的不一致使用，可能会让读者感到困惑。- 人工智能的目标被广义地提出，这可以进一步细化，以更好地反映人工智能系统模拟或增强人类智能的意图。**逻辑连贯性：**- 从人工智能到机器学习再到深度学习的过渡通常是顺畅的，但对于这些概念之间相互作用的缺乏明确解释可能会打断对领域不熟悉的读者的逻辑流程。- 需要明确定义术语及其子集之间的关系，以避免逻辑上的不一致。**可读性：**- 文本提供了信息，但缺乏叙事技巧和现实世界案例，这些案例可以更积极地吸引读者。- 对于机器学习和深度学习方法的重复解释可能会让文本显得冗余，降低其吸引力。**改进建议：**1. **科学词汇选择：**   - 明确且一致地定义“机器学习”和“深度学习”。   - 将“弱人工智能”替换为“窄人工智能”，并为“强人工智能”和“通用人工智能”提供精确的定义，以避免混淆。   - 使用“通用人工智能”来指代能够执行人类可以完成的任何智力任务的人工智能，并明确指出这是一个复杂且持续进行的研究目标。2. **逻辑连贯性：**   - 通过明确解释人工智能、机器学习和深度学习体系中每个概念如何建立在先前概念之上，来增强逻辑流程。   - 提供一个清晰的“机器学习”及其子集（包括监督学习、无监督学习和强化学习）的层次结构和关系。3. **参与度：**   - 结合叙事技巧、现实世界案例和类比，使内容更具相关性和吸引力。   - 使用案例研究或轶事来说明人工智能、机器学习和深度学习的实际应用。4. **重复：**   - 简化机器学习和深度学习方法的解释，避免不必要的重复，并改善文本的流畅性。5. **逻辑不一致：**   - 确保使用的术语一致，并清楚地解释术语之间的关系，以避免逻辑上的不一致。通过实施这些建议，文章可以显著改进，提供更科学准确、逻辑连贯且引人入胜的人工智能、机器学习和深度学习概述。', 'SR_COT_FB_Reflection3_2': '经过仔细的重新考虑和核实，以下是科学文章中识别出的问题，以及可能出现类似问题的潜在领域：**科学词汇选择：**- “弱人工智能”一词与“窄人工智能”混用，这并不准确。“弱人工智能”通常指功能有限的AI，而“窄人工智能”更准确地描述了为特定任务设计的系统。- “强人工智能”用于描述“通用人工智能”，这是一个指具有通用智能的AI的术语。文章可以从更详细地解释这些术语之间的区别中受益。- 有时“机器学习”一词没有与“深度学习”区分开来，而“深度学习”是机器学习的一个子集。这种缺乏区分可能会导致读者混淆。**科学准确性：**- 对AI目标的表述过于宽泛，可能无法准确反映AI目标的多元性。更细致地解释AI旨在模仿或增强人类智能的目标将更为精确。- 声称通用人工智能仍处于研究阶段可能会误导。虽然通用人工智能仍然是一个具有挑战性的目标，但仍有一些AI应用不属于通用人工智能，但非常复杂。**逻辑不一致：**- 文章没有为“机器学习”和“深度学习”提供一致的定义，这可能导致读者出现逻辑上的不一致。- 在“弱人工智能”和“窄人工智能”之间，以及“强人工智能”和“通用人工智能”之间的区分不够清晰，这可能导致逻辑上的不一致。**连续性缺失：**- 从AI到ML再到DL的过渡很平滑，但没有明确解释每个概念是如何建立在先前概念之上的，这可能会给对领域不熟悉的读者造成连续性缺失的感觉。**其他问题：**- 文章在机器学习和深度学习方法的解释中存在重复，这些重复可以通过简化来提高清晰度和参与度。- 文本可以受益于更多的叙事技巧和现实世界案例，以增强参与度和可读性。**修改后的评估：**1. **科学词汇选择：**   - 将“弱人工智能”替换为“窄人工智能”，并为“强人工智能”和“通用人工智能”提供明确的定义。   - 区分“机器学习”和“深度学习”，并解释它们与其他ML子集的关系。2. **科学准确性：**   - 精炼AI目标的解释，强调其模仿或增强人类智能的作用。   - 承认那些不属于通用人工智能但仍然非常复杂的AI系统的发展。3. **逻辑不一致：**   - 确保对“机器学习”和“深度学习”及其子集提供一致和清晰的定义。   - 提供AI、ML和DL之间的清晰层次关系，以避免逻辑上的不一致。4. **连续性缺失：**   - 通过明确解释AI、ML和DL层次结构中的每个概念是如何发展和建立在先前概念之上的，来增强逻辑流。5. **参与度：**   - 结合叙事技巧、现实世界案例和类比，使内容更具吸引力和相关性。   - 简化重复的解释，以提高文本的流畅性和可读性。通过解决这些问题，文章可以显著改进，以提供更科学准确、逻辑一致且引人入胜的AI、ML和DL概述。', 'SR_COT_FB_agent_summary': '问题：上述文章是否包含“重复”现象？答案：是单项评分：- 文章中“机器学习”一词多次重复出现，且表达方式没有变化。这种重复可以通过简化来提高可读性。- 引言中重复了“人工智能的目标是使计算机执行需要人类智能的任务”这一短语，可以用更细腻的表述来避免重复。- “深度学习”的解释在引言和正文中有细微的重复。问题：上述文章是否包含“逻辑不一致”（包括有缺陷的科学推理）？答案：是单项评分：- 文章声称“人工智能的目标是使计算机能够执行通常需要人类智能的任务”，然后又断言“人工智能旨在在各个领域复制或增强人类智能”。这两个陈述在人工智能目标范围上不一致，造成了逻辑上的不一致。- 文章声称“通用人工智能仍处于研究阶段”，但随后提到了一些不属于通用人工智能但仍然高度复杂的AI应用。这造成了逻辑上的不一致，因为它暗示了存在一些高级的AI系统并不属于通用人工智能。问题：上述文章是否包含“间断性”（科学解释中缺乏平滑过渡）？答案：是单项评分：- 从AI到ML再到DL的过渡是平滑的，但在深度学习的背景下引入神经网络时，如果在对DL进行深入探讨之前简要解释一下什么是神经网络，将有助于避免对不熟悉该领域的读者造成间断性。问题：上述文章是否包含“科学词汇选择问题”（科学术语误用或解释不清）？答案：是单项评分：- 用“弱人工智能”来描述“窄人工智能”，这是对“弱人工智能”术语的误用，因为它暗示了窄人工智能系统固有的局限性并不存在。- 使用“强人工智能”一词而没有定义其范围，这可能导致对强人工智能构成要素的理解产生误解。- 文章没有足够清楚地区分“机器学习”和“深度学习”，这可能会让读者感到困惑。问题：文章是否保持了“参与度与可读性”（清晰解释，吸引人的风格）？答案：是单项评分：- 文章提供了概念的解释，但它缺乏能够更积极地吸引读者的叙事技巧或问题。- 文本具有信息性，但缺乏现实世界的例子或类比可能会增强可读性和参与度。最终得分：3分。计算过程：- 重复1分- 逻辑不一致1分- 科学词汇选择问题1分', 'final_score': '最终得分：7分。解释如下：- 问题：上述文章是否包含“重复”现象？回答：是。单项问题得分：1分。- 问题：上述文章是否包含“逻辑不一致”（包括错误的科学推理）？回答：是。单项问题得分：1分。- 问题：上述文章是否包含“不连贯”（科学解释中缺乏平滑过渡）？回答：是。单项问题得分：1分。- 问题：上述文章是否包含“科学词汇选择问题”（科学术语误用或解释不清晰）？回答：是。单项问题得分：1分。- 问题：上述文章是否包含“科学准确性问题”（事实错误或误导性陈述）？回答：是。单项问题得分：1分。- 问题：文章是否保持了“吸引力和可读性”（清晰的解释，吸引人的风格）？回答：否。单项问题得分：0分。文章包含重复、逻辑不一致、不连贯和科学词汇选择问题，每项问题得1分。文章没有包含科学准确性问题，并且保持了吸引力和可读性，这些不在评分范围内。', 'text_summary': '这篇文章存在一些影响其质量的问题。其中包含重复内容，特别是像“机器学习”这样的术语以及“人工智能的目标是让计算机执行需要人类智能的任务”这样的短语，这些都影响了阅读的流畅性。由于一些说法相互矛盾，如人工智能的目标范围和高级人工智能系统的分类，导致逻辑上存在不一致性。此外，文章在介绍神经网络部分也存在断续性，以及科学词汇选择上的问题，包括“弱人工智能”的误用和“强人工智能”缺乏明确的定义。尽管存在这些缺陷，文章通过清晰的解释保持了吸引力和可读性。最终评分反映了基于重复、逻辑不一致和科学词汇选择问题的3点评估。'}
    }
    return jsonify(analyze_info)

#
# def get_knowledge(entity):
#     """模拟获取知识图谱信息"""
#     # 实际情况会通过请求第三方API返回数据，此处造数据
#     if entity == "人工智能":
#         return {
#             "data": {
#                 "entity": "人工智能",
#                 "avp": [
#                     ("定义", "人工智能是模拟人类智能的计算机系统"),
#                     ("应用", "自然语言处理"),
#                     ("应用", "计算机视觉"),
#                     ("技术", "机器学习"),
#                     ("技术", "深度学习"),
#                     ("领域", "数据挖掘"),
#                     ("领域", "自动化"),
#                     ("相关技术", "神经网络"),
#                     ("相关技术", "强化学习"),
#                     ("未来", "改变社会")
#                 ]
#             }
#         }
#     elif entity == "机器学习":
#         return {
#             "data": {
#                 "entity": "机器学习",
#                 "avp": [
#                     ("定义", "机器学习是一种通过数据训练模型的技术"),
#                     ("方法", "监督学习"),
#                     ("方法", "无监督学习"),
#                     ("方法", "强化学习"),
#                     ("应用", "推荐系统"),
#                     ("应用", "预测分析"),
#                     ("相关技术", "深度学习"),
#                     ("相关技术", "支持向量机"),
#                     ("工具", "TensorFlow"),
#                     ("工具", "PyTorch")
#                 ]
#             }
#         }
#     elif entity == "深度学习":
#         return {
#             "data": {
#                 "entity": "深度学习",
#                 "avp": [
#                     ("定义", "深度学习是一种基于神经网络的机器学习方法"),
#                     ("框架", "TensorFlow"),
#                     ("框架", "PyTorch"),
#                     ("框架", "Keras"),
#                     ("应用", "计算机视觉"),
#                     ("应用", "语音识别"),
#                     ("应用", "自然语言处理"),
#                     ("模型", "CNN"),
#                     ("模型", "RNN"),
#                     ("模型", "Transformer")
#                 ]
#             }
#         }
#     else:
#         return {"data": {"entity": entity, "avp": []}}

select_nodes=['人工智能','机器学习','深度学习','人工智能是模拟人类智能的计算机系统','机器学习是一种通过数据训练模型的技术','深度学习是一种基于神经网络的机器学习方法']

@app.route("/kg/knowledge", methods=["GET"])
def knowledge_get():
    """GET 方法获取知识图谱信息"""
    entity = request.args.get("entity")
    if not entity:
        return jsonify({"message": "error", "error": "Missing entity parameter"}), 400

    result = get_knowledge(entity)
    graph_data = construct_graph_data(result)
    for node in graph_data["nodes"]:
        name = node["name"]
        if name in select_nodes:
            node['select'] = 1
    return jsonify(graph_data)

@app.route("/kg/knowledge1", methods=["GET"])
def knowledge_get1():
    """GET 方法获取知识图谱信息"""
    entity = request.args.get("entity")
    if not entity:
        return jsonify({"message": "error", "error": "Missing entity parameter"}), 400

    result = get_knowledge(entity)
    # graph_data = construct_graph_data(result)
    nodes = [{'id': '人工智能', 'name': '人工智能', 'layer': 1, 'select': 1}, {'id': '人工智能是模拟人类智能的计算机系统', 'name': '人工智能是模拟人类智能的计算机系统', 'layer': 2, 'select': 1},  {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1}, {'id': '深度学习', 'name': '深度学习', 'layer': 2, 'select': 1}, {'id': '机器学习', 'name': '机器学习', 'layer': 2, 'select': 1}, {'id': '机器学习是一种通过数据训练模型的技术', 'name': '机器学习是一种通过数据训练模型的技术', 'layer': 3, 'select': 1},{'id': '深度学习', 'name': '深度学习', 'layer': 3, 'select': 0}, {'id': '深度学习', 'name': '深度学习', 'layer': 4, 'select': 1}, {'id': '深度学习是一种基于神经网络的机器学习方法', 'name': '深度学习是一种基于神经网络的机器学习方法', 'layer': 5, 'select': 1}]
    graph_data = {'nodes': nodes, 'links': [{'source': '人工智能', 'target': '人工智能是模拟人类智能的计算机系统', 'label': '定义'}, {'source': '人工智能', 'target': '机器学习', 'label': '技术'}, {'source': '人工智能', 'target': '深度学习', 'label': '技术'},{'source': '机器学习', 'target': '机器学习是一种通过数据训练模型的技术', 'label': '定义'}, {'source': '机器学习', 'target': '深度学习', 'label': '相关技术'}, {'source': '深度学习', 'target': '深度学习是一种基于神经网络的机器学习方法', 'label': '定义'}]}

    return jsonify(graph_data)



def construct_graph_data(data, base_layer=1):
    """将返回的数据转换为图结构，并为边添加标签"""
    if "data" not in data:
        return {"nodes": [], "links": []}
    try:
        entity = data["data"].get("entity", "人工智能")

        avp = data["data"].get("avp", [])

        nodes = [{"id": entity, "name": entity, "layer": base_layer,"select":0}]
        links = []

        for idx, (attribute, value) in enumerate(avp):
            nodes.append({"id": value, "name": value, "layer": base_layer + 1,"select":0})
            links.append({"source": entity, "target": value, "label": attribute})

        if entity == "人工智能":
            ml_data = get_knowledge("机器学习")
            ml_graph = construct_graph_data(ml_data, base_layer + 1)

            # 添加“机器学习”节点和子图
            nodes.extend(ml_graph["nodes"])
            links.extend(ml_graph["links"])
        # 如果当前节点是 "机器学习"，衍生“深度学习”子图
        if entity == "机器学习":
            dl_data = get_knowledge("深度学习")
            dl_graph = construct_graph_data(dl_data, base_layer + 2)  # 机器学习是第2层，深度学习在第3层
            nodes.extend(dl_graph["nodes"])
            links.extend(dl_graph["links"])
        return {"nodes": nodes, "links": links}
    except:
        return {"nodes": [], "links": []}

@app.route("/kg/perKnowCheckPort", methods=["GET"])
def knowledge_per():
    """GET 方法获取知识图谱信息"""
    result={
  "class_info": {
    "school": "北京101中学",
      "academy": "计算机与人工智能学院",
    "grade": "初三",
    "class": "精英班",
    "subject": "计算机科学与技术"
  },
  "student_profile": {
    "age": 18,
    "learning_preference": "动手学",
    "logic_ability": "强",
    "memory_ability": "强",
    "attention_span": "2小时",
    "stress_management": "强"
  },
  "cognitive_level": {
    "level_name": "计算机科学探索者",
    "level_description": "该群体已经具备了计算机科学的坚实基础，理解并掌握了计算机的核心概念和技术，如数据结构、算法、编程语言及操作系统等基本内容。具有较强的分析和解决问题的能力，能够在多个领域内进行深入思考和学习，探索并实践技术的应用。从软件开发到数据科学、人工智能等领域，均能独立进行项目设计和技术实现。此外，该群体具备较强的跨学科学习能力，能够将计算机科学的知识应用于其他学科领域，发现并推动创新点，适合进一步探索计算机科学的更多应用与前沿创新，如量子计算、深度学习、区块链等新兴技术",
    "level_range": "熟练者至进阶者",
    "survey_results": {
      "beginner": {
        "questions_answered": 4,
        "questions": [
          "解释二分查找的概念，并举例说明如何使用它在一个有序列表中高效地查找元素。",
          "描述算法复杂度类概念，如P、NP、NP-完全和NP-难。",
          "在Web开发背景下，你会如何评估和选择在新的项目中使用单体架构与微服务架构？",
          "讨论量子计算可能带来的未来发展和其对密码学的影响。"
        ]
      },
      "proficient": {
        "questions_answered": 4,
        "questions": [
          "解释‘大数据’的概念，并举例说明如何在市场营销、医疗保健或金融领域应用。",
          "讨论分布式数据库背后的原理及其相对于集中式数据库的优势。",
          "在开发高性能计算应用的情况下，面临GPU和CPU计算的选择。",
          "讨论人工智能的未来发展方向，包括神经网络架构的进步。"
        ]
      },
      "advanced": {
        "questions_answered": 4,
        "questions": [
          "解释区块链的概念，并举例说明区块链如何在实际应用中发挥作用。",
          "描述卷积神经网络（CNN）背后的原理，并分析其对图像数据中空间层次问题的解决。",
          "如何选择分布式文件系统和基于云的存储解决方案。",
          "探讨量子计算可能的未来发展趋势及其对密码学的影响。"
        ]
      }
    }
  },
  "recommended_resources": {
    "books": [
      {
        "title": "计算机程序设计艺术",
        "author": "Donald E. Knuth",
        "description": "深入掌握算法和程序设计的基础，适合进一步提升逻辑思维和问题解决能力的学生。"
      },
      {
        "title": "深入理解计算机系统",
        "author": "Randal E. Bryant & David R. O'Hallaron",
        "description": "适合深入了解计算机硬件与软件之间的关系，增强学生对计算机系统的全局理解。"
      },
      {
        "title": "人工智能：一种现代的方法",
        "author": "Stuart Russell & Peter Norvig",
        "description": "深入学习人工智能的核心理论及应用，适合对人工智能有兴趣的学生。"
      },  {
    "title": "C程序设计",
    "author": "谭浩强",
    "description": "通过本书，学生能够掌握 C 语言的基础知识与编程技巧，适合作为计算机科学与技术专业的大一教材。"
  },
  {
    "title": "数据结构",
    "author": "严蔚敏, 吴伟民",
    "description": "这是一本经典的数据结构教材，适合学习计算机数据结构的基本概念及其实现方法，是计算机科学基础课程的重要教材。"
  },
    ],
    "online_courses": [
      {
        "title": "Coursera的计算机科学与算法课程",
        "description": "通过实际项目帮助学生巩固算法和数据结构的知识。"
      },
      {
        "title": "edX的人工智能入门课程",
        "description": "适合学生进一步了解人工智能和机器学习的核心算法和应用。"
      }
    ]
  },
  "learning_path": {
    "step1": "巩固基础知识，尤其是数据结构与算法，提升问题解决能力。",
    "step2": "拓展技术深度，学习大数据、人工智能等领域的前沿技术。",
    "step3": "探索高阶领域，如量子计算、区块链等，了解其潜在的应用与挑战。",
    "suggestions": "通过更多的项目实践来巩固所学知识，参加相关领域的竞赛，进一步提升计算机科学能力。"
  }
}
    return jsonify(result)

@app.route("/kg/qa", methods=["GET"])
def knowledge_qa():
    type = request.args.get("type")
    question = request.args.get("question")
    client = GLM4Client('49a1ea5cbfd14ba8b57a200e9d1387da.Ak0mVn7Zrm1LLgiO')
    if type == 'init':
        return jsonify({'type':'ai','content':'您好，我是一个专业的知识专家，您可以向我提问任何问题。'})
    else:
        result =  client.send('针对北京计算机专业大一新生的知识水平做出回答。你是一个专业的知识回答专家,回答不要有特殊字符',question)
        return jsonify({'type':'ai','content': result})

@app.route("/kg/getQuestion", methods=["GET"])
def knowledge_question():
    result = [{
                "name": '入门者',
                "img": 'https://peredu-1322695558.cos.ap-beijing.myqcloud.com/survey/beginner.png',
                "questions": ["解释二分查找的概念，并举例说明如何使用它在一个有序列表中高效地查找元素。讨论二分查找与线性查找在时间复杂度和实际应用方面的区别。", "描述算法复杂度类概念，如P、NP、NP-完全和NP-难。分析一个算法被归类为NP-难的含义，并讨论为这类问题找到多项式时间解的潜在挑战。", "在Web开发背景下，你会如何评估和选择在新的项目中使用单体架构与微服务架构？讨论你会考虑的标准，并对每种方法的权衡进行简要分析。", "讨论量子计算可能带来的未来发展和其对密码学的影响。识别实施量子抗性算法的当前挑战，并解释这些挑战如何可能塑造未来十年网络安全的发展。"],
                "has": '0/4'
            }, {
                "name": '熟练者',
                "img": 'https://peredu-1322695558.cos.ap-beijing.myqcloud.com/survey/proficient.png',
                "questions": ['解释“大数据”的概念，并举例说明如何在现实场景中应用，例如在市场营销、医疗保健或金融领域。讨论在你的例子中数据分析的重要性。', '讨论分布式数据库背后的原理及其相对于集中式数据库的优势。分析设计分布式数据库系统时涉及的权衡，包括数据一致性、复制和容错性的考虑。', '在开发高性能计算应用的情况下，你面临在基于GPU的计算和基于CPU的计算之间进行选择。解释你将使用的标准来选择适当的技术，并从成本、性能要求和计算任务性质等因素来论证你的选择。', '考虑人工智能和机器学习领域。讨论人工智能可能的未来发展方向，包括神经网络架构的进步，并确定该领域在未来十年可能面临的关键挑战。你预计这些挑战将如何被解决？'],
                "has": '0/4'
            }, {
                "name": '进阶者',
                "img": 'https://peredu-1322695558.cos.ap-beijing.myqcloud.com/survey/advanced.png',
                "questions": ['解释区块链的概念，并举例说明区块链如何在实际应用中发挥作用，例如供应链管理。讨论在此背景下使用区块链的优势和潜在局限性。', '在机器学习的背景下，描述卷积神经网络（CNN）背后的原理以及它是如何解决图像数据中的空间层次问题。分析不同卷积层对CNN性能的影响，包括池化层的作用及其对网络泛化能力的影响。', '一个公司正寻求为其大规模数据分析平台实施新的数据存储解决方案的场景。作为一名高级专家，概述在分布式文件系统（如Hadoop分布式文件系统HDFS）和基于云的存储解决方案（如Amazon S3）之间进行选择的准则。讨论这些选项在成本、可扩展性、性能和数据本地性方面的权衡。', '探讨量子计算可能的未来发展趋势及其对密码学的影响。讨论为了使量子计算机对当前密码系统构成实际威胁需要解决的问题。详细阐述量子抗性算法研究如何塑造安全数据传输和存储的未来。'],
                "has": '0/4'
            }, {
                "name": '专家型',
                "img": 'https://peredu-1322695558.cos.ap-beijing.myqcloud.com/survey/expert.png',
                "questions": ['描述一个基于微服务的系统架构，并分析在扩展此类系统时出现的挑战，包括如何解决这些挑战。', '在开发用于科学研究的超高性能计算集群的背景下，在选择合适的硬件和软件组件时，你会考虑哪些关键因素？请解释你的选择过程，考虑到成本、性能、能源效率和易于维护等因素。用具体例子来证明你的选择。', '解释量子计算的未来发展路径，并讨论为实现其全部潜力需要克服的主要挑战。你预计量子计算将如何与现有的经典计算系统集成，这对网络安全和数据保护有何影响？', '作为计算机科学的一个基础概念，解释哈希函数的概念及其在数据结构和算法中的重要性。提供一个哈希函数在现实世界应用中的例子，例如在分布式数据库的实现中，并讨论在此背景下使用哈希函数的优势和潜在缺点。'],
                "has": '0/4'
            }]
    return jsonify({'result': result})

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8000, debug=True)